

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Gaussian wave packet running into a potential barrier &mdash; QuantumOptics.jl</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="QuantumOptics.jl" href="../index.html"/>
        <link rel="up" title="Examples" href="../examples.html"/>
        <link rel="next" title="Raman Transition of a \(\Lambda\)-scheme Atom" href="raman.html"/>
        <link rel="prev" title="Particle in harmonic trap potential" href="particle-in-harmonic-trap.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  


  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> QuantumOptics.jl
          

          
          </a>

          
            
            
              <div class="version">
                0.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../documentation/documentation.html">Documentation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="pumped-cavity.html">Pumped cavity</a></li>
<li class="toctree-l2"><a class="reference internal" href="jaynes-cummings.html">Jaynes-Cummings model</a></li>
<li class="toctree-l2"><a class="reference internal" href="particle-in-harmonic-trap.html">Particle in harmonic trap potential</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Gaussian wave packet running into a potential barrier</a></li>
<li class="toctree-l2"><a class="reference internal" href="raman.html">Raman Transition of a <span class="math">\(\Lambda\)</span>-scheme Atom</a></li>
<li class="toctree-l2"><a class="reference internal" href="two-qubit-entanglement.html">Entanglement of Two Qubits</a></li>
<li class="toctree-l2"><a class="reference internal" href="correlation-spectrum.html">Two-time correlation function and spectrum of a Fock state</a></li>
<li class="toctree-l2"><a class="reference internal" href="manybody-fourlevel-system.html">Four level system in many-body formalism</a></li>
<li class="toctree-l2"><a class="reference internal" href="nparticles-in-double-well.html">N-Particles in a double-well potential</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">QuantumOptics.jl</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../examples.html">Examples</a> &raquo;</li>
        
      <li>Gaussian wave packet running into a potential barrier</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/examples/particle-into-barrier.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <p><em>This notebook can be found on</em>
<a class="reference external" href="https://github.com/bastikr/QuantumOptics.jl/blob/master/examples/particle-into-barrier.ipynb">github</a></p>
<div class="section" id="gaussian-wave-packet-running-into-a-potential-barrier">
<span id="example-particle-into-barrier"></span><h1>Gaussian wave packet running into a potential barrier<a class="headerlink" href="#gaussian-wave-packet-running-into-a-potential-barrier" title="Permalink to this headline">¶</a></h1>
<p>In this example, we simulate the dynamics of a Gaussian wave packet that
runs into a square potential barrier. In this, we make use of the FFT
relations between position and momentum bases, which allows us to boost
the efficiency of the calculation. To this end, the so-called Lazy
operatorations (LazyProduct and LazySum) are used.</p>
<div class="code julia highlight-julia"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="n">QuantumOptics</span>
<span class="k">using</span> <span class="n">PyPlot</span>
</pre></div>
</div>
<p>First, we define a position basis and calculate the respective momentum
basis by means of an FFT (numerically by simply passing the position
basis as argument). The position basis is defined by its range in space.</p>
<div class="code julia highlight-julia"><div class="highlight"><pre><span></span><span class="n">xmin</span> <span class="o">=</span> <span class="o">-</span><span class="mi">30</span>
<span class="n">xmax</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">Npoints</span> <span class="o">=</span> <span class="mi">200</span>

<span class="n">b_position</span> <span class="o">=</span> <span class="n">PositionBasis</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">Npoints</span><span class="p">)</span>
<span class="n">b_momentum</span> <span class="o">=</span> <span class="n">MomentumBasis</span><span class="p">(</span><span class="n">b_position</span><span class="p">);</span>
</pre></div>
</div>
<p>Once this is done, we define a sqaure potential barrier of width
<span class="math">\(d\)</span> and height <span class="math">\(V_0\)</span> in the position basis.</p>
<div class="code julia highlight-julia"><div class="highlight"><pre><span></span><span class="n">V0</span> <span class="o">=</span> <span class="mf">1.</span> <span class="c"># Height of Barrier</span>
<span class="n">d</span> <span class="o">=</span> <span class="mi">5</span> <span class="c"># Width of Barrier</span>
<span class="k">function</span> <span class="n">V_barrier</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">d</span><span class="o">/</span><span class="mi">2</span> <span class="o">||</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="n">d</span><span class="o">/</span><span class="mi">2</span>
        <span class="k">return</span> <span class="mf">0.</span>
    <span class="k">else</span>
        <span class="k">return</span> <span class="n">V0</span>
    <span class="k">end</span>
<span class="k">end</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">potentialoperator</span><span class="p">(</span><span class="n">b_position</span><span class="p">,</span> <span class="n">V_barrier</span><span class="p">);</span>
</pre></div>
</div>
<p>For the kinetic energy term we can exploit that it is diagonal in the
momentum basis. In the time evolution we want to first transform the
density operator from the position to the momentum basis, multiply it
with the kinetic operator and then transform it back. This can be done
by using the FFTOperator which when applied to a density operator will
perform such a transformation. The LazyProduct operator makes it
possible to chain these three operations together.</p>
<div class="code julia highlight-julia"><div class="highlight"><pre><span></span><span class="n">Txp</span> <span class="o">=</span> <span class="n">FFTOperator</span><span class="p">(</span><span class="n">b_position</span><span class="p">,</span> <span class="n">b_momentum</span><span class="p">)</span>
<span class="n">Tpx</span> <span class="o">=</span> <span class="n">FFTOperator</span><span class="p">(</span><span class="n">b_momentum</span><span class="p">,</span> <span class="n">b_position</span><span class="p">)</span>
<span class="n">Hkin</span> <span class="o">=</span> <span class="n">LazyProduct</span><span class="p">(</span><span class="n">Txp</span><span class="p">,</span> <span class="n">momentumoperator</span><span class="p">(</span><span class="n">b_momentum</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">Tpx</span><span class="p">);</span>
</pre></div>
</div>
<p>Since the kinetic energy operator is never really calculated and only
its action onto a density operator is defined we also cannot directly
add another operator to it. Instead we also have to delay this sum so
that it is only performed indirectly when applied to a density oeprator.
This can be done with the LazySum operator.</p>
<div class="code julia highlight-julia"><div class="highlight"><pre><span></span><span class="n">H</span> <span class="o">=</span> <span class="n">LazySum</span><span class="p">(</span><span class="n">Hkin</span><span class="p">,</span> <span class="n">V</span><span class="p">);</span>
</pre></div>
</div>
<p>Finally we let gaussian wave packets start on the left side of the
barrier and analyze the time evolution. The offset of the packet on the
y-axis here indicates the initial kinetic energy.</p>
<div class="code julia highlight-julia"><div class="highlight"><pre><span></span><span class="n">xpoints</span> <span class="o">=</span> <span class="n">samplepoints</span><span class="p">(</span><span class="n">b_position</span><span class="p">)</span>

<span class="n">x0</span> <span class="o">=</span> <span class="o">-</span><span class="mi">15</span>
<span class="n">sigma0</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">p0vec</span> <span class="o">=</span> <span class="p">[</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.1</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">timecuts</span> <span class="o">=</span> <span class="mi">20</span>

<span class="k">for</span> <span class="n">i_p</span> <span class="kp">in</span> <span class="mi">1</span><span class="o">:</span><span class="n">length</span><span class="p">(</span><span class="n">p0vec</span><span class="p">)</span>
    <span class="n">p0</span> <span class="o">=</span> <span class="n">p0vec</span><span class="p">[</span><span class="n">i_p</span><span class="p">]</span>
    <span class="n">Ψ₀</span> <span class="o">=</span> <span class="n">gaussianstate</span><span class="p">(</span><span class="n">b_position</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">sigma0</span><span class="p">)</span>
    <span class="n">scaling</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">maximum</span><span class="p">(</span><span class="n">abs</span><span class="p">(</span><span class="n">Ψ₀</span><span class="o">.</span><span class="n">data</span><span class="p">))</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="mi">5</span>
    <span class="n">n0</span> <span class="o">=</span> <span class="n">abs</span><span class="p">(</span><span class="n">Ψ₀</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.^</span><span class="mi">2</span><span class="o">*</span><span class="n">scaling</span>

    <span class="n">tmax</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">abs</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">p0</span><span class="o">+</span><span class="mf">0.2</span><span class="p">)</span>
    <span class="n">T</span> <span class="o">=</span> <span class="n">collect</span><span class="p">(</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">tmax</span><span class="p">,</span> <span class="n">timecuts</span><span class="p">))</span>
    <span class="n">tout</span><span class="p">,</span> <span class="n">Ψt</span> <span class="o">=</span> <span class="n">timeevolution</span><span class="o">.</span><span class="n">schroedinger</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">Ψ₀</span><span class="p">,</span> <span class="n">H</span><span class="p">);</span>

    <span class="n">offset</span> <span class="o">=</span> <span class="n">real</span><span class="p">(</span><span class="n">expect</span><span class="p">(</span><span class="n">Hkin</span><span class="p">,</span> <span class="n">Ψ₀</span><span class="p">))</span>
    <span class="n">plot</span><span class="p">(</span><span class="n">xpoints</span><span class="p">,</span> <span class="n">n0</span><span class="o">+</span><span class="n">offset</span><span class="p">,</span> <span class="s">&quot;C</span><span class="si">$i_p</span><span class="s">--&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="o">:</span><span class="n">length</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
        <span class="n">Ψ</span> <span class="o">=</span> <span class="n">Ψt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">abs</span><span class="p">(</span><span class="n">Ψ</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.^</span><span class="mi">2</span><span class="o">*</span><span class="n">scaling</span>
        <span class="n">plot</span><span class="p">(</span><span class="n">xpoints</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="n">offset</span><span class="p">,</span> <span class="s">&quot;C</span><span class="si">$i_p</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="k">end</span>
    <span class="n">nt</span> <span class="o">=</span> <span class="n">abs</span><span class="p">(</span><span class="n">Ψt</span><span class="p">[</span><span class="n">timecuts</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.^</span><span class="mi">2</span><span class="o">*</span><span class="n">scaling</span>
    <span class="n">plot</span><span class="p">(</span><span class="n">xpoints</span><span class="p">,</span> <span class="n">nt</span><span class="o">+</span><span class="n">offset</span><span class="p">,</span> <span class="s">&quot;C</span><span class="si">$i_p</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">end</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">V_barrier</span><span class="o">.</span><span class="p">(</span><span class="n">xpoints</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">xpoints</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">&quot;k&quot;</span><span class="p">)</span>
<span class="n">fill_between</span><span class="p">(</span><span class="n">xpoints</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&quot;k&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/particle-into-barrier_12_0.png" src="../_images/particle-into-barrier_12_0.png" />
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="raman.html" class="btn btn-neutral float-right" title="Raman Transition of a \(\Lambda\)-scheme Atom" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="particle-in-harmonic-trap.html" class="btn btn-neutral" title="Particle in harmonic trap potential" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, Sebastian Krämer.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>