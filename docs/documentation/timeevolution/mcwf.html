

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Monte Carlo wave function time evolution &mdash; QuantumOptics.jl</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="QuantumOptics.jl" href="../../index.html"/>
        <link rel="up" title="Time-evolution" href="timeevolution.html"/>
        <link rel="next" title="Steady state" href="../steadystate.html"/>
        <link rel="prev" title="Master time evolution" href="master.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  


  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> QuantumOptics.jl
          

          
          </a>

          
            
            
              <div class="version">
                0.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/tutorial.html">Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../documentation.html">Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../quantumobjects/quantumobjects.html">Quantum objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quantumsystems/quantumsystems.html">Quantum systems</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="timeevolution.html">Time-evolution</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="schroedinger.html">Schroedinger time evolution</a></li>
<li class="toctree-l3"><a class="reference internal" href="master.html">Master time evolution</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Monte Carlo wave function time evolution</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../steadystate.html">Steady state</a></li>
<li class="toctree-l2"><a class="reference internal" href="../timecorrelations.html">Two-time correlation functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spectralanalysis.html">Spectral Analysis</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">QuantumOptics.jl</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../documentation.html">Documentation</a> &raquo;</li>
        
          <li><a href="timeevolution.html">Time-evolution</a> &raquo;</li>
        
      <li>Monte Carlo wave function time evolution</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/documentation/timeevolution/mcwf.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="monte-carlo-wave-function-time-evolution">
<span id="section-mcwf"></span><h1>Monte Carlo wave function time evolution<a class="headerlink" href="#monte-carlo-wave-function-time-evolution" title="Permalink to this headline">¶</a></h1>
<p>Instead of solving the Master equation</p>
<div class="math">
\[\dot{\rho} = -\frac{i}{\hbar} \big[H,\rho\big]
             + \sum_i \big(
                    J_i \rho J_i^\dagger
                    - \frac{1}{2} J_i^\dagger J_i \rho
                    - \frac{1}{2} \rho J_i^\dagger J_i
                \big)\]</div>
<p>directly, one can use the quantum jump formalism to evaluate single stochastic quantum trajectories using the Monte Carlo wave function method. For large numbers of trajectories the statistical average then approximates the result of the Master equation. The huge advantage is that instead of describing the state of the quantum system by a density matrix of size <span class="math">\(N^2\)</span> these trajectories work in terms of state vectors of size <span class="math">\(N\)</span>. This is somewhat negated by the stochastic nature of the formalism which makes it necessary to repeat the simulation until the wanted accuracy is reached. It turns out, however, that for many cases, especially for high dimensional quantum systems, the necessary number of repetitions is much smaller than the system size <span class="math">\(N\)</span> and therefore using the MCWF method is advantageous.</p>
<p>Additionally this quantum jump formalism also has a very intuitive physical interpretation. It basically describes the situation where every quantum jump, e.g. the emission of a photon, is detected by a detector and therefore the time evolution can be completely reconstructed by an outside observer. Depending on the efficiency of the used detectors this might be a much better description for an actual experiment.</p>
<p>This physical picture can be used to easily understand the actual MCWF algorithm:</p>
<ol class="arabic">
<li><p class="first">Calculate coherent time evolution according to a Schroedinger equation with non-hermitian Hamiltonian <span class="math">\(H_\mathrm{nh} = H - \frac{i\hbar}{2} \sum_i J_i^\dagger J_i\)</span></p>
<blockquote>
<div><div class="math">
\[i\hbar\frac{\mathrm{d}}{\mathrm{d} t} |\Psi(t)\rangle = H_\mathrm{nh} |\Psi(t)\rangle\]</div>
</div></blockquote>
</li>
<li><p class="first">Since the Hamiltonian is non-hermitian the norm of the quantum state is not conserved and actually decreases with time. This can be interpreted in the way that the smaller the norm of the state gets the more probable it is that a quantum jump occurs. Quantitatively this means that the coherent time evolution stops when <span class="math">\(\langle \Psi(t)|\Psi(t)\rangle &lt; p\)</span> where <span class="math">\(p\)</span> is a randomly generated number between 0 and 1.</p>
</li>
<li><p class="first">At these randomly determined times a quantum jump according to</p>
<blockquote>
<div><div class="math">
\[|\Psi(t)\rangle \rightarrow \frac{J_i |\Psi(t)\rangle}{||J_i |\Psi(t)\rangle||}\]</div>
<p>is performed.</p>
</div></blockquote>
</li>
<li><p class="first">Continue with coherent time evolution.</p>
</li>
</ol>
<p>The stochastic average of these trajectories is then equal to the solution of the master equation <span class="math">\(\rho(t)\)</span></p>
<div class="math">
\[\lim\limits_{N \rightarrow \infty}\frac{1}{N} \sum_{k=1}^N |\Psi^k(t)\rangle\langle\Psi^k(t)| = \rho(t)\]</div>
<p>and also the stochastic average of the single trajectory expectation values is equal to the expectation value according to the master equation</p>
<div class="math">
\[\lim\limits_{N \rightarrow \infty}\frac{1}{N} \sum_{k=1}^N \langle\Psi^k(t)| A |\Psi^k(t)\rangle = \mathrm{Tr}\big\{A \rho(t)\big\}\]</div>
<p>avoiding explicit calculations of density matrices.</p>
<p>The function computing a time evolution with the MCWF method can be called analogously to <a class="reference internal" href="../../api.html#master-ba24c2fffbe32ab8cb2efcd34a0bbe8b" title="master"><code class="xref jl jl-func docutils literal"><span class="pre">master</span></code></a>, namely with:</p>
<div class="highlight-julia"><div class="highlight"><pre><span></span><span class="n">mcwf</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span> <span class="n">psi0</span><span class="o">::</span><span class="n">Ket</span><span class="p">,</span> <span class="n">H</span><span class="o">::</span><span class="n">Operator</span><span class="p">,</span> <span class="n">J</span><span class="o">::</span><span class="kt">Vector</span><span class="p">)</span>
</pre></div>
</div>
<p>Since this function only calculates state vectors (as explained above), it requires the initial state in the form of a ket.</p>
<p>As shown above, the concept of the MCWF method requires jumps of the form <span class="math">\(J_i|\psi\rangle\)</span> to be applied at certain times. Therefore, it is not possible
to calculate the time evolution according to a MCWF for Lindblad terms of the form <span class="math">\(\sum_{i,j}\gamma_{ij}\left(J_i\rho J_j^\dagger - J_i^\dagger J_j\rho/2 - \rho J_i^\dagger J_j/2\right)\)</span>,
since such a Lindblad term relies on the the multiplication of two different jump operators <span class="math">\(J_i\)</span> and <span class="math">\(J_j\)</span> from the left and right, respectively, with the density matrix <span class="math">\(\rho\)</span>.
However, it is possible to write such a Lindblad term in diagonal form <span class="math">\(\sum_i d_i \left(D_i\rho D_i^\dagger - D_i^\dagger D_i\rho - \rho D_i^\dagger D_i\right)\)</span>.
Here, <span class="math">\(d_i\)</span> are the eigenvalues of the matrix with entries <span class="math">\(\gamma_{ij}\)</span> and the diagonal jump operators <span class="math">\(D_i\)</span> are defined by</p>
<div class="math">
\[D_i = \sum_k v^{(i)}_k J_k,\]</div>
<p>where <span class="math">\(v^{(i)}\)</span> is the eigenvector corresponding to the eigenvalue <span class="math">\(d_i\)</span>.</p>
<p>This diagonalization is implemented with the function</p>
<ul class="simple">
<li><a class="reference internal" href="../../api.html#diagonaljumps-bd56f74df0065eeedd801bca842981f9" title="diagonaljumps(Gamma::Array{Float64}, J::Vector)"><code class="xref jl jl-func docutils literal"><span class="pre">diagonaljumps(Gamma::Array{Float64},</span> <span class="pre">J::Vector)</span></code></a></li>
</ul>
<p>which returns the eigenvalues (new decay rates) and the corresponding set of jump operators.
As a quick example, say you have three spin-1/2 particles that decay collectively. When using the master equation solver you can simply pass the matrix containing the collective decay rates
as a keyword argument. To do the same with the MCWF we need to do:</p>
<div class="highlight-julia"><div class="highlight"><pre><span></span><span class="n">spinbasis</span> <span class="o">=</span> <span class="n">SpinBasis</span><span class="p">(</span><span class="mi">1</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span>
<span class="n">threespinbasis</span> <span class="o">=</span> <span class="n">spinbasis</span> <span class="n">⊗</span> <span class="n">spinbasis</span> <span class="n">⊗</span> <span class="n">spinbasis</span>
<span class="n">sm</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">embed</span><span class="p">(</span><span class="n">threespinbasis</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">sigmam</span><span class="p">(</span><span class="n">spinbasis</span><span class="p">))</span>

<span class="n">Γ</span><span class="p">,</span> <span class="n">γ₁</span><span class="p">,</span> <span class="n">γ₂</span><span class="p">,</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.2</span>
<span class="n">Gamma</span> <span class="o">=</span> <span class="p">[</span><span class="n">Γ</span> <span class="n">γ₁</span> <span class="n">γ₂</span><span class="p">;</span> <span class="n">γ₁</span> <span class="n">Γ</span> <span class="n">γ₁</span><span class="p">;</span> <span class="n">γ₂</span> <span class="n">γ₁</span> <span class="n">Γ</span><span class="p">]</span>
<span class="n">J</span> <span class="o">=</span> <span class="p">[</span><span class="n">sm</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="o">:</span><span class="mi">3</span><span class="p">]</span>

<span class="n">d</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="n">diagonaljumps</span><span class="p">(</span><span class="n">Gamma</span><span class="p">,</span> <span class="n">J</span><span class="p">)</span>
</pre></div>
</div>
<p>Now, we can call the solver with the acquired jump operators <code class="docutils literal"><span class="pre">D</span></code> multiplied by their corresponding rates <code class="docutils literal"><span class="pre">d</span></code> like so:</p>
<div class="highlight-julia"><div class="highlight"><pre><span></span><span class="n">tout</span><span class="p">,</span> <span class="n">ψₜ</span> <span class="o">=</span> <span class="n">timeevolution</span><span class="o">.</span><span class="n">mcwf</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span> <span class="n">ψ₀</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="p">[</span><span class="n">sqrt</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="o">:</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference internal" href="../../examples/pumped-cavity.html#example-pumped-cavity"><span class="std std-ref">Pumped cavity</span></a></li>
<li><a class="reference internal" href="../../examples/jaynes-cummings.html#example-jaynes-cummings"><span class="std std-ref">Jaynes-Cummings model</span></a></li>
</ul>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../steadystate.html" class="btn btn-neutral float-right" title="Steady state" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="master.html" class="btn btn-neutral" title="Master time evolution" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, Sebastian Krämer.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'0.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>